{%- comment -%}
List essays from:
1) Posts in category 'essays'         -> site.categories.essays
2) Pages stored under /Essays/        -> site.pages filtered by URL
   (also matches lowercase /essays/ just in case)
{%- endcomment -%}

{%- assign essay_posts = site.categories.essays | default: empty -%}
{%- assign essay_pages_upper = site.pages | where_exp: "p", "p.url contains '/Essays/' and p.url != page.url" -%}
{%- assign essay_pages_lower = site.pages | where_exp: "p", "p.url contains '/essays/' and p.url != page.url" -%}
{%- assign essay_pages = essay_pages_upper | concat: essay_pages_lower -%}

{%- assign essays = essay_posts | concat: essay_pages | uniq -%}
{%- assign essays_sorted = essays | sort: "date" | reverse -%}

{%- if essays_sorted and essays_sorted.size > 0 -%}
  <div class="list-group">
    {%- for e in essays_sorted -%}
      <a class="list-group-item list-group-item-action" href="{{ e.url | relative_url }}">
        <div class="d-flex w-100 justify-content-between">
          <h5 class="mb-1">{{ e.title }}</h5>
          {%- if e.date -%}
            <small class="text-muted">{{ e.date | date: "%b %d, %Y" }}</small>
          {%- endif -%}
        </div>
        {%- if e.summary -%}
          <p class="mb-1">{{ e.summary }}</p>
        {%- elsif e.excerpt -%}
          <p class="mb-1">{{ e.excerpt | strip_html | truncate: 160 }}</p>
        {%- endif -%}
      </a>
    {%- endfor -%}
  </div>
{%- else -%}
  <p>No essays yet.</p>
{%- endif -%}
